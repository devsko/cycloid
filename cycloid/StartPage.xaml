<UserControl
    x:Class="cycloid.StartPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ic="using:FluentIcons.Uwp"
    xmlns:local="using:cycloid"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:media="using:CommunityToolkit.WinUI.Media"
    xmlns:ui="using:CommunityToolkit.WinUI"
    Loaded="UserControl_Loaded">

    <UserControl.Resources>

        <x:Double x:Key="PopupWidth">700</x:Double>
        <x:Double x:Key="PopupHeight">390</x:Double>

        <Style
            BasedOn="{StaticResource DefaultToggleButtonStyle}"
            TargetType="ToggleButton">
            <Setter Property="Width" Value="28" />
            <Setter Property="Height" Value="28" />
            <Setter Property="Padding" Value="0" />
        </Style>

    </UserControl.Resources>

    <Grid Background="DarkSlateGray">
        <Popup
            x:Name="Popup"
            Width="{StaticResource PopupWidth}"
            Height="{StaticResource PopupHeight}"
            HorizontalAlignment="Center"
            VerticalAlignment="Center">
            <Border>
                <ui:Effects.Shadow>
                    <media:AttachedCardShadow Offset="4,8" Color="#60000000" />
                </ui:Effects.Shadow>
                <Border
                    x:Name="Border"
                    Width="{StaticResource PopupWidth}"
                    Height="{StaticResource PopupHeight}"
                    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
                    CornerRadius="5">
                    <Grid
                        Margin="30"
                        ColumnSpacing="24"
                        RowSpacing="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock
                            Grid.ColumnSpan="2"
                            FontSize="24"
                            Text="cycloid" />
                        <TextBlock
                            Grid.Row="1"
                            FontSize="16"
                            Text="Open recent track" />
                        <TextBlock
                            Grid.Row="1"
                            Grid.Column="1"
                            FontSize="16"
                            Text="Get started" />
                        <ListView
                            x:Name="Tracks"
                            Grid.Row="2"
                            DoubleTapped="Tracks_DoubleTapped"
                            ItemsSource="{x:Bind Mode=OneTime, Path=local:App.Current.ViewModel.TrackListItems}"
                            PreviewKeyDown="Tracks_PreviewKeyDown">
                            <ListView.ItemTemplate>
                                <DataTemplate x:DataType="local:TrackListItem">
                                    <Grid Padding="0,6,0,6" ColumnSpacing="10">
                                        <Grid.RowDefinitions>
                                            <RowDefinition />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Grid ColumnSpacing="4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock FontSize="16" Text="{x:Bind Mode=OneTime, Path=Name}" />
                                            <TextBlock
                                                Grid.Column="1"
                                                FontSize="16"
                                                Text="{x:Bind Mode=OneTime, Path=local:Format.Distance(TrackDistance)}" />
                                        </Grid>
                                        <Grid Grid.Row="1" ColumnSpacing="4">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>
                                            <TextBlock
                                                FontSize="12"
                                                Text="{x:Bind Mode=OneTime, Path=FilePath}"
                                                TextTrimming="CharacterEllipsis" />
                                            <TextBlock
                                                Grid.Column="1"
                                                FontSize="12"
                                                HorizontalTextAlignment="Right"
                                                Text="{x:Bind Mode=OneTime, Path=local:Format.Date(LastAccessDate)}" />
                                        </Grid>
                                        <ToggleButton
                                            Grid.RowSpan="2"
                                            Grid.Column="2"
                                            IsChecked="{x:Bind Mode=TwoWay, Path=IsPinned}"
                                            VerticalAlignment="Center">
                                            <ToggleButton.Content>
                                                <ic:SymbolIcon FontSize="14" Symbol="Pin" />
                                            </ToggleButton.Content>
                                        </ToggleButton>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                        <StackPanel
                            Grid.Row="2"
                            Grid.Column="1"
                            Width="180"
                            Spacing="12">
                            <StackPanel.Resources>
                                <Style TargetType="Button">
                                    <Setter Property="HorizontalAlignment" Value="Stretch" />
                                    <Setter Property="HorizontalContentAlignment" Value="Left" />
                                </Style>
                                <Style x:Key="ButtonStackPanel" TargetType="StackPanel">
                                    <Setter Property="Padding" Value="0,8,0,8" />
                                    <Setter Property="Orientation" Value="Horizontal" />
                                    <Setter Property="Spacing" Value="12" />
                                </Style>
                            </StackPanel.Resources>
                            <Button Tapped="OpenFile">
                                <Button.Content>
                                    <StackPanel Style="{StaticResource ButtonStackPanel}">
                                        <SymbolIcon Symbol="OpenFile" />
                                        <TextBlock Text="Open a track" />
                                    </StackPanel>
                                </Button.Content>
                            </Button>
                            <Button Tapped="CreateFile">
                                <Button.Content>
                                    <StackPanel Style="{StaticResource ButtonStackPanel}">
                                        <ic:SymbolIcon Symbol="DocumentAdd" />
                                        <TextBlock Text="Crate a new track" />
                                    </StackPanel>
                                </Button.Content>
                            </Button>
                        </StackPanel>
                    </Grid>
                </Border>
            </Border>
        </Popup>
    </Grid>
</UserControl>
