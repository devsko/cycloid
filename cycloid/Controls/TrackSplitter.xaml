<ItemsControl
    x:Class="cycloid.Controls.TrackSplitter"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:cycloid="using:cycloid"
    xmlns:local="using:cycloid.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    PointerEntered="ItemsControl_PointerEntered"
    PointerExited="ItemsControl_PointerExited">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <Canvas Background="#00000000" />
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    <ItemsControl.ItemTemplate>
        <DataTemplate x:DataType="cycloid:TrackSplit">
            <Canvas>
                <Path
                    Data="M 0,12 L 6,1 L12,12 Z"
                    Fill="CadetBlue"
                    Visibility="{x:Bind Mode=OneTime, Path=cycloid:Convert.VisibleIfNot(CanNotMove)}" />
                <local:MapControlBorder
                    Canvas.Left="{Binding Mode=OneWay, RelativeSource={RelativeSource Mode=TemplatedParent}, Path=LeftOfGapText}"
                    Canvas.Top="-8"
                    Margin="-5,0,0,0"
                    Padding="1"
                    CornerRadius="1"
                    IsHitTestVisible="False"
                    Loaded="MapControlBorder_Loaded"
                    Opacity="{Binding Mode=OneWay, RelativeSource={RelativeSource Mode=TemplatedParent}, Path=GapTextOpacity}"
                    Visibility="{Binding Mode=OneWay, RelativeSource={RelativeSource Mode=TemplatedParent}, Path=GapTextVisibility}">
                    <Border
                        Padding="1"
                        BorderBrush="{x:Bind Mode=OneWay, Path=local:TrackSplitter.RedIfInvalid(IsValid)}"
                        BorderThickness="1">
                        <TextBlock FontSize="10" Text="{x:Bind Mode=OneWay, Path=cycloid:Format.Numeric(DistanceToNext)}" />
                    </Border>
                </local:MapControlBorder>
            </Canvas>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl>
